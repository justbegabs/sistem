<!DOCTYPE html>
<!--
    Licensed to the Apache Software Foundation (ASF) under one
    or more contributor license agreements.  See the NOTICE file
    distributed with this work for additional information
    regarding copyright ownership.  The ASF licenses this file
    to you under the Apache License, Version 2.0 (the
    "License"); you may not use this file except in compliance
    with the License.  You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

    Unless required by applicable law or agreed to in writing,
    software distributed under the License is distributed on an
    "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
     KIND, either express or implied.  See the License for the
    specific language governing permissions and limitations
    under the License.
-->
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ficha de Personagem</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="styles.css">
    <style>
        html,
        body {
            background: #C24914 !important;
            margin: 0;
            padding: 20px;
            min-height: 100vh;
        }

        :root[data-theme="dark"] body {
            background: #000000 !important;
        }

        .pericias {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
        }

        .pericias h2 {
            color: var(--cor-preta);
            margin-bottom: 20px;
            text-align: center;
        }

        .pericias-grid {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .pericia-principal {
            background: rgba(255, 180, 100, 0.55);
            border-radius: 8px;
            padding: 15px;
            text-align: left;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: space-between;
            border: 1px solid rgba(255, 255, 255, 0.4);
            backdrop-filter: blur(3px);
        }

        .pericia-principal:hover {
            transform: translateY(-2px);
        }

        .pericia-principal h3 {
            color: var(--cor-cinza);
            margin: 0;
            font-size: 1.1em;
        }

        .pericia-principal::after {
            content: '›';
            color: var(--cor-cinza);
            font-size: 1.5em;
            transition: transform 0.3s ease;
        }

        .pericia-principal:hover::after {
            transform: translateX(5px);
        }

        .modal-pericias {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
        }

        .modal-pericias .modal-content {
            background: #ffffff;
            margin: 10% auto;
            padding: 20px;
            border-radius: 10px;
            width: 80%;
            max-width: 500px;
            position: relative;
        }

        .modal-pericias h2 {
            color: #F2780C;
            margin-bottom: 20px;
            text-align: center;
        }

        .pericia-list {
            display: flex;
            flex-direction: column;
            gap: 10px;
            max-height: 400px;
            overflow-y: auto;
            padding-right: 10px;
        }

        /* Estilização da barra de rolagem */
        .pericia-list::-webkit-scrollbar {
            width: 8px;
        }

        .pericia-list::-webkit-scrollbar-track {
            background: rgba(242, 120, 12, 0.1);
            border-radius: 4px;
        }

        .pericia-list::-webkit-scrollbar-thumb {
            background: rgba(242, 120, 12, 0.3);
            border-radius: 4px;
        }

        .pericia-list::-webkit-scrollbar-thumb:hover {
            background: rgba(242, 120, 12, 0.5);
        }

        /* Ajuste para o tema escuro */
        :root[data-theme="dark"] .pericia-list::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.1);
        }

        :root[data-theme="dark"] .pericia-list::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.2);
        }

        :root[data-theme="dark"] .pericia-list::-webkit-scrollbar-thumb:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        .pericia-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            background: rgba(255, 180, 100, 0.1);
            border-radius: 5px;
            border: 1px solid rgba(242, 120, 12, 0.2);
        }

        .pericia-item label {
            color: #F2780C;
            cursor: pointer;
            transition: color 0.2s ease;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .pericia-item .dado-icon {
            width: 24px;
            height: 24px;
            cursor: pointer;
            transition: transform 0.3s ease;
            object-fit: contain;
            background-color: transparent;
            padding: 2px;
            border-radius: 4px;
        }

        .pericia-item .dado-icon:hover {
            transform: rotate(180deg);
            background-color: rgba(242, 120, 12, 0.1);
        }

        .pericia-item .valor-container {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .pericia-item label:hover {
            color: #D66A0B;
        }

        .pericia-item input {
            width: 60px;
            text-align: center;
            background: rgba(255, 180, 100, 0.1);
            border: 1px solid rgba(242, 120, 12, 0.3);
            color: #F2780C;
            padding: 5px;
            border-radius: 4px;
        }

        :root[data-theme="dark"] .modal-pericias .modal-content {
            background: #1a1a1a;
        }

        :root[data-theme="dark"] .modal-pericias h2 {
            color: #F2780C;
        }

        :root[data-theme="dark"] .pericia-item {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        :root[data-theme="dark"] .pericia-item label {
            color: #F2780C;
        }

        :root[data-theme="dark"] .pericia-item input {
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.1);
            color: #F2780C;
        }

        :root[data-theme="dark"] .pericias {
            background: rgba(0, 0, 0, 0.3);
        }

        :root[data-theme="dark"] .pericia-principal {
            background: rgba(255, 255, 255, 0.05);
        }

        :root[data-theme="dark"] .pericia-principal h3 {
            color: #F2780C;
        }

        .inventario {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
        }

        .inventario h2 {
            color: var(--cor-preta);
            margin-bottom: 15px;
            text-align: center;
        }

        .inventario-info {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            font-weight: bold;
            color: var(--cor-cinza);
        }

        .lista-itens {
            display: flex;
            flex-direction: column;
            gap: 8px;
            margin-bottom: 10px;
        }

        .item-inventario {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .item-inventario input[type="text"] {
            flex: 1;
            padding: 6px;
            border-radius: 4px;
            border: 1px solid #ccc;
        }

        .item-inventario button {
            background: #F2780C;
            color: #fff;
            border: none;
            border-radius: 4px;
            padding: 4px 8px;
            cursor: pointer;
            font-size: 1em;
        }

        .item-inventario button:hover {
            background: #c95e09;
        }

        #adicionar-item {
            width: 100%;
            background: #F2780C;
            color: #fff;
            border: none;
            border-radius: 4px;
            padding: 8px;
            font-size: 1em;
            cursor: pointer;
            margin-top: 5px;
        }

        #adicionar-item:disabled {
            background: #aaa;
            cursor: not-allowed;
        }

        :root[data-theme="dark"] .inventario {
            background: rgba(0, 0, 0, 0.3);
        }

        :root[data-theme="dark"] .inventario h2 {
            color: #F2780C;
        }

        :root[data-theme="dark"] .inventario-info {
            color: #F2780C;
        }

        :root[data-theme="dark"] .item-inventario input[type="text"] {
            background: #222;
            color: #fff;
            border: 1px solid #444;
        }

        :root[data-theme="dark"] .item-inventario button {
            background: #F2780C;
            color: #fff;
        }

        :root[data-theme="dark"] #adicionar-item {
            background: #F2780C;
        }
    </style>
</head>

<body>
    <header>
        <div class="header-content">
            <button class="voltar">← Voltar</button>
            <div class="header-buttons">
                <button class="tema" onclick="toggleTheme()">
                    <i id="themeIcon" class="fas fa-sun"></i>
                    Tema
                </button>
                <button class="obs">OBS</button>
                <button class="salvar">Salvar</button>
            </div>
        </div>
    </header>
    <div class="container">
        <!-- Div específica para o background -->
        <div class="background-container"></div>

        <section class="informacoes-basicas">
            <h2>Informações Básicas</h2>
            <div class="grid-container">
                <div class="input-group full">
                    <label>Nome</label>
                    <input type="text" placeholder="Nome do personagem">
                </div>
                <div class="input-group">
                    <label>Idade</label>
                    <input type="number" placeholder="Idade">
                </div>
                <div class="input-group">
                    <label>Data de Nascimento</label>
                    <input type="date" placeholder="Ex: 01/01/1990">
                </div>
                <div class="input-group">
                    <label>Altura</label>
                    <input type="text" placeholder="Ex: 1,75m">
                </div>
                <div class="input-group">
                    <label>Tipo Sanguíneo</label>
                    <input type="text" placeholder="Ex: A+">
                </div>
                <div class="input-group full">
                    <label>Sexualidade</label>
                    <input type="text" placeholder="Sexualidade">
                </div>
            </div>
        </section>

        <section class="nivel">
            <label>Nível</label>
            <div class="status-bar">
                <button onmousedown="startDecrementNivel()" onmouseup="stopNivelInterval()"
                    onmouseleave="stopNivelInterval()">-</button>
                <input type="number" id="nivel-input" value="0" min="0" max="100" onchange="atualizarNivel(this)">
                <button onmousedown="startIncrementNivel()" onmouseup="stopNivelInterval()"
                    onmouseleave="stopNivelInterval()">+</button>
            </div>
            <div class="progress-bar">
                <div class="progress" id="nivel-progress" style="width: 0%;"></div>
            </div>
        </section>

        <section class="status-vitais">
            <h2>Status Vitais</h2>
            <div class="status-grid">
                <div class="status-item">
                    <label>❤️ Vida</label>
                    <div class="status-bar">
                        <input type="number" value="0" min="0" max="20" onchange="atualizarStatus(this)"> /
                        <span>20</span>
                    </div>
                    <div class="barra-progresso vida"></div>
                </div>
                <div class="status-item">
                    <label>🧠 Sanidade</label>
                    <div class="status-bar">
                        <input type="number" value="0" min="0" max="10" onchange="atualizarStatus(this)"> / <span>10</span>
                    </div>
                    <div class="barra-progresso sanidade"></div>
                </div>
                <div class="status-item">
                    <label>⚡ Mana</label>
                    <div class="status-bar">
                        <input type="number" value="0" min="0" max="15" onchange="atualizarStatus(this)"> /
                        <span>15</span>
                    </div>
                    <div class="barra-progresso mana"></div>
                </div>
                <div class="status-item">
                    <label>⭐ Alma</label>
                    <div class="status-bar">
                        <input type="number" value="0" min="0" max="15" onchange="atualizarStatus(this)"> /
                        <span>15</span>
                    </div>
                    <div class="barra-progresso alma"></div>
                </div>
            </div>
        </section>

        <div class="grid-2-columns">
            <section class="status-combate">
                <h2>Status de Combate</h2>
                <div class="status-list">
                    <div class="status-item">
                        <label>Defesa</label>
                        <input type="number" value="10" readonly>
                    </div>
                    <div class="status-item">
                        <label>Esquiva</label>
                        <input type="number" value="10" readonly>
                    </div>
                    <div class="status-item">
                        <label>Bloqueio</label>
                        <input type="number" value="0" readonly>
                    </div>
                </div>
            </section>

            <section class="info-personagem">
                <h2 id="titulo-info-personagem">Informações do Personagem</h2>
                <div class="info-list">
                    <div class="info-item">
                        <label>Raça</label>
                        <input type="text" placeholder="Raça" readonly onclick="openRacaModal()">
                    </div>
                    <div class="info-item">
                        <label>Classe</label>
                        <input type="text" placeholder="Classe" readonly onclick="openClasseModal()">
                    </div>
                    <div class="info-item">
                        <label>Origem</label>
                        <input type="text" placeholder="Origem" readonly onclick="openOrigemModal()">
                    </div>
                    <div class="info-item" id="familia-base-item" style="display: none;">
                        <label>Família-Base</label>
                        <input type="text" placeholder="Família-Base" readonly onclick="openFamiliaBaseModal()">
                    </div>
                </div>
            </section>
        </div>

        <div class="grid-2-columns">
            <section class="atributos-teste">
                <h2>Atributos de Teste <span>0/12</span></h2>
                <div class="atributos-list">
                    <div class="atributo-item">
                        <label>Força</label>
                        <input type="number" value="0" min="-5">
                    </div>
                    <div class="atributo-item">
                        <label>Destreza</label>
                        <input type="number" value="0" min="-5">
                    </div>
                    <div class="atributo-item">
                        <label>Intelecto</label>
                        <input type="number" value="0" min="-5">
                    </div>
                    <div class="atributo-item">
                        <label>Carisma</label>
                        <input type="number" value="0" min="-5">
                    </div>
                    <div class="atributo-item">
                        <label>Magia</label>
                        <input type="number" value="0" min="-5">
                    </div>
                    <div class="atributo-item">
                        <label>Constituição</label>
                        <input type="number" value="0" min="-5">
                    </div>
                </div>
            </section>

            <section class="atributos-sorte">
                <h2>Atributos de Sorte <span>0/12</span></h2>
                <div class="atributos-list">
                    <div class="atributo-item">
                        <label>Sorte</label>
                        <input type="number" value="0" min="-5">
                    </div>
                    <div class="atributo-item">
                        <label>Fama</label>
                        <input type="number" value="0" min="-5">
                    </div>
                    <div class="atributo-item">
                        <label>Resiliência</label>
                        <input type="number" value="0" min="-5">
                    </div>
                    <div class="atributo-item">
                        <label>Fé</label>
                        <input type="number" value="0" min="-5">
                    </div>
                    <div class="atributo-item">
                        <label>Criatividade</label>
                        <input type="number" value="0" min="-5">
                    </div>
                </div>
            </section>
        </div>

        <section class="pericias">
            <h2>
                Perícias
                <span class="contador-pericias" style="float:right;font-size:0.8em;font-weight:normal;margin-left:8px;"></span>
            </h2>
            <div class="pericias-grid">
                <div class="pericia-principal" onclick="abrirModalPericia('Força')">
                    <h3>Força</h3>
                </div>
                <div class="pericia-principal" onclick="abrirModalPericia('Destreza')">
                    <h3>Destreza</h3>
                </div>
                <div class="pericia-principal" onclick="abrirModalPericia('Intelecto')">
                    <h3>Intelecto</h3>
                </div>
                <div class="pericia-principal" onclick="abrirModalPericia('Carisma')">
                    <h3>Carisma</h3>
                </div>
                <div class="pericia-principal" onclick="abrirModalPericia('Magia')">
                    <h3>Magia</h3>
                </div>
                <div class="pericia-principal" onclick="abrirModalPericia('Constituição')">
                    <h3>Constituição</h3>
                </div>
            </div>
        </section>

        <!-- Caixa de Inventário -->
        <section class="inventario">
            <h2>Inventário</h2>
            <div class="inventario-info">
                <span>Capacidade: <span id="capacidade-inventario">0</span></span>
                <span>Itens: <span id="contador-itens">0</span></span>
            </div>
            <div id="lista-itens" class="lista-itens"></div>
            <button type="button" id="adicionar-item">Adicionar Item</button>
        </section>

        <!-- Modal de Perícias -->
        <div class="modal-pericias" id="modal-pericias">
            <div class="modal-content">
                <span class="close-modal" onclick="fecharModalPericia()">&times;</span>
                <h2 id="modal-pericia-titulo">Perícias de </h2>
                <div class="pericia-list" id="modal-pericia-lista">
                    <!-- Lista de perícias será preenchida via JavaScript -->
                </div>
            </div>
        </div>
    </div>

    <!-- Modal de Seleção de Raça -->
    <div class="modal-racas" id="modal-racas">
        <div class="modal-content">
            <span class="close-modal" onclick="closeRacaModal()">&times;</span>
            <h2>Selecione sua Raça</h2>
            <div class="raca-grid">
                <div class="raca-card" data-raca="Anjo">
                    <h3>Anjo</h3>
                    <p>Ser celestial divino com poderes sagrados e asas majestosas.</p>
                    <button class="selecionar-raca" onclick="selecionarRaca('Anjo', this)">Selecionar</button>
                </div>
                <div class="raca-card" data-raca="Anjo Caído">
                    <h3>Anjo Caído</h3>
                    <p>Um ser celestial que perdeu sua graça divina, mas manteve parte de seus poderes.</p>
                    <button class="selecionar-raca" onclick="selecionarRaca('Anjo Caído', this)">Selecionar</button>
                </div>
                <div class="raca-card" data-raca="Banshee">
                    <h3>Banshee</h3>
                    <p>Espírito feminino conhecido por seu grito mortal e presságios de morte.</p>
                    <button class="selecionar-raca" onclick="selecionarRaca('Banshee', this)">Selecionar</button>
                </div>
                <div class="raca-card" data-raca="Bruxa">
                    <h3>Bruxa</h3>
                    <p>Praticante de magia antiga com domínio sobre feitiços e poções.</p>
                    <button class="selecionar-raca" onclick="selecionarRaca('Bruxa', this)">Selecionar</button>
                </div>
                <div class="raca-card" data-raca="Ciborgue">
                    <h3>Ciborgue</h3>
                    <p>Ser híbrido de orgânico e mecânico com capacidades aprimoradas.</p>
                    <button class="selecionar-raca" onclick="selecionarRaca('Ciborgue', this)">Selecionar</button>
                </div>
                <div class="raca-card" data-raca="Demônio">
                    <h3>Demônio</h3>
                    <p>Criatura das profundezas infernais com poderes sobrenaturais.</p>
                    <button class="selecionar-raca" onclick="selecionarRaca('Demônio', this)">Selecionar</button>
                </div>
                <div class="raca-card" data-raca="Elfo">
                    <h3>Elfo</h3>
                    <p>Ser místico com forte conexão com a natureza e magia ancestral.</p>
                    <button class="selecionar-raca" onclick="selecionarRaca('Elfo', this)">Selecionar</button>
                </div>
                <div class="raca-card" data-raca="Esqueleto">
                    <h3>Esqueleto</h3>
                    <p>Guerreiro não-morto que mantém suas habilidades de combate.</p>
                    <button class="selecionar-raca" onclick="selecionarRaca('Esqueleto', this)">Selecionar</button>
                </div>
                <div class="raca-card" data-raca="Fae">
                    <h3>Fae</h3>
                    <p>Criatura feérica com poderes mágicos e natureza travessa.</p>
                    <button class="selecionar-raca" onclick="selecionarRaca('Fae', this)">Selecionar</button>
                </div>
                <div class="raca-card" data-raca="Fauno/Sátiro">
                    <h3>Fauno/Sátiro</h3>
                    <p>Ser meio-humano meio-bode com afinidade musical e natural.</p>
                    <button class="selecionar-raca" onclick="selecionarRaca('Fauno/Sátiro', this)">Selecionar</button>
                </div>
                <div class="raca-card" data-raca="Humano">
                    <h3>Humano</h3>
                    <p>Ser versátil com grande potencial de adaptação e aprendizado.</p>
                    <button class="selecionar-raca" onclick="selecionarRaca('Humano', this)">Selecionar</button>
                </div>
                <div class="raca-card" data-raca="Kanima">
                    <h3>Kanima</h3>
                    <p>Criatura metamorfa com habilidades reptilianas.</p>
                    <button class="selecionar-raca" onclick="selecionarRaca('Kanima', this)">Selecionar</button>
                </div>
                <div class="raca-card" data-raca="Kitsune">
                    <h3>Kitsune</h3>
                    <p>Espírito raposa com poderes místicos e múltiplas caudas.</p>
                    <button class="selecionar-raca" onclick="selecionarRaca('Kitsune', this)">Selecionar</button>
                </div>
                <div class="raca-card" data-raca="Lobisomem">
                    <h3>Lobisomem</h3>
                    <p>Metamorfo com capacidade de transformação em lobo.</p>
                    <button class="selecionar-raca" onclick="selecionarRaca('Lobisomem', this)">Selecionar</button>
                </div>
                <div class="raca-card" data-raca="Metamorfo">
                    <h3>Metamorfo</h3>
                    <p>Ser capaz de alterar sua forma física à vontade.</p>
                    <button class="selecionar-raca" onclick="selecionarRaca('Metamorfo', this)">Selecionar</button>
                </div>
                <div class="raca-card" data-raca="Neko">
                    <h3>Neko</h3>
                    <p>Humanoide com características felinas e agilidade natural.</p>
                    <button class="selecionar-raca" onclick="selecionarRaca('Neko', this)">Selecionar</button>
                </div>
                <div class="raca-card" data-raca="Nogitsune">
                    <h3>Nogitsune</h3>
                    <p>Espírito raposa maligno que se alimenta de caos e dor.</p>
                    <button class="selecionar-raca" onclick="selecionarRaca('Nogitsune', this)">Selecionar</button>
                </div>
                <div class="raca-card" data-raca="Semideus">
                    <h3>Semideus</h3>
                    <p>Descendente de deuses com poderes divinos herdados.</p>
                    <button class="selecionar-raca" onclick="selecionarRaca('Semideus', this)">Selecionar</button>
                </div>
                <div class="raca-card" data-raca="Sereia/Tritão">
                    <h3>Sereia/Tritão</h3>
                    <p>Ser aquático com poderes místicos das profundezas.</p>
                    <button class="selecionar-raca" onclick="selecionarRaca('Sereia/Tritão', this)">Selecionar</button>
                </div>
                <div class="raca-card" data-raca="Siren">
                    <h3>Siren</h3>
                    <p>Criatura marinha com canto hipnótico e poderes de persuasão.</p>
                    <button class="selecionar-raca" onclick="selecionarRaca('Siren', this)">Selecionar</button>
                </div>
                <div class="raca-card" data-raca="Súcubo">
                    <h3>Súcubo</h3>
                    <p>Demônio sedutor que se alimenta de energia vital.</p>
                    <button class="selecionar-raca" onclick="selecionarRaca('Súcubo', this)">Selecionar</button>
                </div>
                <div class="raca-card" data-raca="Vampiro">
                    <h3>Vampiro</h3>
                    <p>Imortal que se alimenta de sangue com poderes sobrenaturais.</p>
                    <button class="selecionar-raca" onclick="selecionarRaca('Vampiro', this)">Selecionar</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal de Seleção de Classe -->
    <div class="modal-classes" id="modal-classes">
        <div class="modal-content">
            <span class="close-modal" onclick="closeClasseModal()">&times;</span>
            <h2>Selecione sua Classe</h2>
            <div class="classe-grid">
                <div class="classe-card" data-classe="Armadilheiro">
                    <h3>Armadilheiro</h3>
                    <p>Especialista em criar e desarmar armadilhas, mestre da preparação tática.</p>
                    <div class="classe-habilidades">
                        <h4>Habilidades Iniciais:</h4>
                        <ul>
                            <li>Criar Armadilhas</li>
                            <li>Detectar Perigos</li>
                            <li>Sabotagem</li>
                        </ul>
                    </div>
                    <button class="selecionar-classe"
                        onclick="selecionarClasse('Armadilheiro', this)">Selecionar</button>
                </div>
                <div class="classe-card" data-classe="Atirador">
                    <h3>Atirador</h3>
                    <p>Mestre em combate à distância com precisão letal.</p>
                    <div class="classe-habilidades">
                        <h4>Habilidades Iniciais:</h4>
                        <ul>
                            <li>Tiro Preciso</li>
                            <li>Mira Aprimorada</li>
                            <li>Disparo Rápido</li>
                        </ul>
                    </div>
                    <button class="selecionar-classe" onclick="selecionarClasse('Atirador', this)">Selecionar</button>
                </div>
                <div class="classe-card" data-classe="Carteado">
                    <h3>Carteado</h3>
                    <p>Manipulador de cartas místicas com poderes sobrenaturais.</p>
                    <div class="classe-habilidades">
                        <h4>Habilidades Iniciais:</h4>
                        <ul>
                            <li>Leitura de Cartas</li>
                            <li>Truques Mágicos</li>
                            <li>Destino Alterado</li>
                        </ul>
                    </div>
                    <button class="selecionar-classe" onclick="selecionarClasse('Carteado', this)">Selecionar</button>
                </div>
                <div class="classe-card" data-classe="Clérigo">
                    <h3>Clérigo</h3>
                    <p>Sacerdote divino com poderes de cura e proteção.</p>
                    <div class="classe-habilidades">
                        <h4>Habilidades Iniciais:</h4>
                        <ul>
                            <li>Cura Divina</li>
                            <li>Benção</li>
                            <li>Proteção Sagrada</li>
                        </ul>
                    </div>
                    <button class="selecionar-classe" onclick="selecionarClasse('Clérigo', this)">Selecionar</button>
                </div>
                <div class="classe-card" data-classe="Combatente">
                    <h3>Combatente</h3>
                    <p>Guerreiro versátil especializado em diversos estilos de luta.</p>
                    <div class="classe-habilidades">
                        <h4>Habilidades Iniciais:</h4>
                        <ul>
                            <li>Técnicas de Combate</li>
                            <li>Adaptação Tática</li>
                            <li>Contra-ataque</li>
                        </ul>
                    </div>
                    <button class="selecionar-classe" onclick="selecionarClasse('Combatente', this)">Selecionar</button>
                </div>
                <div class="classe-card" data-classe="Curandeiro">
                    <h3>Curandeiro</h3>
                    <p>Especialista em artes curativas e medicina natural.</p>
                    <div class="classe-habilidades">
                        <h4>Habilidades Iniciais:</h4>
                        <ul>
                            <li>Primeiros Socorros</li>
                            <li>Medicina Natural</li>
                            <li>Remédios Caseiros</li>
                        </ul>
                    </div>
                    <button class="selecionar-classe" onclick="selecionarClasse('Curandeiro', this)">Selecionar</button>
                </div>
                <div class="classe-card" data-classe="Demonologista">
                    <h3>Demonologista</h3>
                    <p>Estudioso das artes demoníacas e poderes infernais.</p>
                    <div class="classe-habilidades">
                        <h4>Habilidades Iniciais:</h4>
                        <ul>
                            <li>Invocação Demoníaca</li>
                            <li>Pactos Sombrios</li>
                            <li>Conhecimento Infernal</li>
                        </ul>
                    </div>
                    <button class="selecionar-classe"
                        onclick="selecionarClasse('Demonologista', this)">Selecionar</button>
                </div>
                <div class="classe-card" data-classe="Domador">
                    <h3>Domador</h3>
                    <p>Mestre na arte de treinar e controlar criaturas.</p>
                    <div class="classe-habilidades">
                        <h4>Habilidades Iniciais:</h4>
                        <ul>
                            <li>Domar Criaturas</li>
                            <li>Empatia Animal</li>
                            <li>Comando de Besta</li>
                        </ul>
                    </div>
                    <button class="selecionar-classe" onclick="selecionarClasse('Domador', this)">Selecionar</button>
                </div>
                <div class="classe-card" data-classe="Espião">
                    <h3>Espião</h3>
                    <p>Mestre da infiltração e coleta de informações.</p>
                    <div class="classe-habilidades">
                        <h4>Habilidades Iniciais:</h4>
                        <ul>
                            <li>Furtividade</li>
                            <li>Disfarce</li>
                            <li>Coleta de Informações</li>
                        </ul>
                    </div>
                    <button class="selecionar-classe" onclick="selecionarClasse('Espião', this)">Selecionar</button>
                </div>
                <div class="classe-card" data-classe="Investigador">
                    <h3>Investigador</h3>
                    <p>Especialista em resolver mistérios e encontrar pistas ocultas.</p>
                    <div class="classe-habilidades">
                        <h4>Habilidades Iniciais:</h4>
                        <ul>
                            <li>Dedução</li>
                            <li>Análise de Cena</li>
                            <li>Interrogatório</li>
                        </ul>
                    </div>
                    <button class="selecionar-classe"
                        onclick="selecionarClasse('Investigador', this)">Selecionar</button>
                </div>
                <div class="classe-card" data-classe="Mago">
                    <h3>Mago</h3>
                    <p>Manipulador de energias arcanas e feitiços poderosos.</p>
                    <div class="classe-habilidades">
                        <h4>Habilidades Iniciais:</h4>
                        <ul>
                            <li>Magias Arcanas</li>
                            <li>Ritual Místico</li>
                            <li>Conhecimento Mágico</li>
                        </ul>
                    </div>
                    <button class="selecionar-classe" onclick="selecionarClasse('Mago', this)">Selecionar</button>
                </div>
                <div class="classe-card" data-classe="Suporte">
                    <h3>Suporte</h3>
                    <p>Especialista em auxiliar e fortalecer aliados.</p>
                    <div class="classe-habilidades">
                        <h4>Habilidades Iniciais:</h4>
                        <ul>
                            <li>Fortificação</li>
                            <li>Inspiração</li>
                            <li>Proteção Aliada</li>
                        </ul>
                    </div>
                    <button class="selecionar-classe" onclick="selecionarClasse('Suporte', this)">Selecionar</button>
                </div>
                <div class="classe-card" data-classe="Tecnológico">
                    <h3>Tecnológico</h3>
                    <p>Mestre em tecnologia avançada e gadgets.</p>
                    <div class="classe-habilidades">
                        <h4>Habilidades Iniciais:</h4>
                        <ul>
                            <li>Hackear</li>
                            <li>Criar Dispositivos</li>
                            <li>Reparo Técnico</li>
                        </ul>
                    </div>
                    <button class="selecionar-classe"
                        onclick="selecionarClasse('Tecnológico', this)">Selecionar</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal de Seleção de Origem -->
    <div class="modal-origens" id="modal-origens">
        <div class="modal-content">
            <span class="close-modal" onclick="closeOrigemModal()">&times;</span>
            <h2>Selecione sua Origem</h2>
            <div class="origem-grid">
                <div class="origem-card" data-origem="amnesico">
                    <h3>Amnésico</h3>
                    <p>Indivíduo que perdeu suas memórias, em busca de seu passado perdido.</p>
                    <button class="selecionar-origem" onclick="selecionarOrigem('Amnésico', this)">Selecionar</button>
                </div>
                <div class="origem-card" data-origem="artista">
                    <h3>Artista</h3>
                    <p>Criador talentoso que expressa sua arte de diversas formas.</p>
                    <button class="selecionar-origem" onclick="selecionarOrigem('Artista', this)">Selecionar</button>
                </div>
                <div class="origem-card" data-origem="conspiracionista">
                    <h3>Conspiracionista</h3>
                    <p>Investigador de teorias ocultas e segredos obscuros.</p>
                    <button class="selecionar-origem"
                        onclick="selecionarOrigem('Conspiracionista', this)">Selecionar</button>
                </div>
                <div class="origem-card" data-origem="crianca-perdida">
                    <h3>Criança Perdida</h3>
                    <p>Jovem que se perdeu de seu lar e cresceu em circunstâncias extraordinárias.</p>
                    <button class="selecionar-origem"
                        onclick="selecionarOrigem('Criança Perdida', this)">Selecionar</button>
                </div>
                <div class="origem-card" data-origem="eremita">
                    <h3>Eremita</h3>
                    <p>Solitário que encontrou sabedoria no isolamento.</p>
                    <button class="selecionar-origem" onclick="selecionarOrigem('Eremita', this)">Selecionar</button>
                </div>
                <div class="origem-card" data-origem="escolhido">
                    <h3>Escolhido</h3>
                    <p>Destinado a cumprir uma profecia ou missão divina.</p>
                    <button class="selecionar-origem" onclick="selecionarOrigem('Escolhido', this)">Selecionar</button>
                </div>
                <div class="origem-card" data-origem="exilado">
                    <h3>Exilado</h3>
                    <p>Banido de sua terra natal, carrega consigo as marcas do passado.</p>
                    <button class="selecionar-origem" onclick="selecionarOrigem('Exilado', this)">Selecionar</button>
                </div>
                <div class="origem-card" data-origem="experimento">
                    <h3>Experimento</h3>
                    <p>Resultado de experiências científicas ou místicas.</p>
                    <button class="selecionar-origem"
                        onclick="selecionarOrigem('Experimento', this)">Selecionar</button>
                </div>
                <div class="origem-card" data-origem="forasteiro">
                    <h3>Forasteiro</h3>
                    <p>Viajante de terras distantes com costumes diferentes.</p>
                    <button class="selecionar-origem" onclick="selecionarOrigem('Forasteiro', this)">Selecionar</button>
                </div>
                <div class="origem-card" data-origem="ginasta">
                    <h3>Ginasta</h3>
                    <p>Atleta com extraordinária destreza física e disciplina.</p>
                    <button class="selecionar-origem" onclick="selecionarOrigem('Ginasta', this)">Selecionar</button>
                </div>
                <div class="origem-card" data-origem="herdeiro">
                    <h3>Herdeiro</h3>
                    <p>Descendente de uma linhagem importante ou poderosa.</p>
                    <button class="selecionar-origem" onclick="selecionarOrigem('Herdeiro', this)">Selecionar</button>
                </div>
                <div class="origem-card" data-origem="inventor">
                    <h3>Inventor</h3>
                    <p>Criador de dispositivos e soluções inovadoras.</p>
                    <button class="selecionar-origem" onclick="selecionarOrigem('Inventor', this)">Selecionar</button>
                </div>
                <div class="origem-card" data-origem="jornalista">
                    <h3>Jornalista</h3>
                    <p>Investigador da verdade e revelador de histórias.</p>
                    <button class="selecionar-origem" onclick="selecionarOrigem('Jornalista', this)">Selecionar</button>
                </div>
                <div class="origem-card" data-origem="militar">
                    <h3>Militar</h3>
                    <p>Treinado nas artes da guerra e disciplina militar.</p>
                    <button class="selecionar-origem" onclick="selecionarOrigem('Militar', this)">Selecionar</button>
                </div>
                <div class="origem-card" data-origem="nomade">
                    <h3>Nômade</h3>
                    <p>Viajante sem lar fixo, adaptável a diferentes culturas.</p>
                    <button class="selecionar-origem" onclick="selecionarOrigem('Nômade', this)">Selecionar</button>
                </div>
                <div class="origem-card" data-origem="profeta">
                    <h3>Profeta</h3>
                    <p>Visionário com a capacidade de prever eventos futuros.</p>
                    <button class="selecionar-origem" onclick="selecionarOrigem('Profeta', this)">Selecionar</button>
                </div>
                <div class="origem-card" data-origem="programador">
                    <h3>Programador</h3>
                    <p>Mestre em códigos e sistemas computacionais.</p>
                    <button class="selecionar-origem"
                        onclick="selecionarOrigem('Programador', this)">Selecionar</button>
                </div>
                <div class="origem-card" data-origem="psicologo">
                    <h3>Psicólogo</h3>
                    <p>Estudioso da mente e comportamento humano.</p>
                    <button class="selecionar-origem" onclick="selecionarOrigem('Psicólogo', this)">Selecionar</button>
                </div>
                <div class="origem-card" data-origem="religioso">
                    <h3>Religioso</h3>
                    <p>Devoto seguidor de crenças e práticas espirituais.</p>
                    <button class="selecionar-origem" onclick="selecionarOrigem('Religioso', this)">Selecionar</button>
                </div>
                <div class="origem-card" data-origem="servente">
                    <h3>Servente</h3>
                    <p>Trabalhador leal que serve a outros com dedicação.</p>
                    <button class="selecionar-origem" onclick="selecionarOrigem('Servente', this)">Selecionar</button>
                </div>
                <div class="origem-card" data-origem="universitario">
                    <h3>Universitário</h3>
                    <p>Estudante em busca de conhecimento acadêmico.</p>
                    <button class="selecionar-origem"
                        onclick="selecionarOrigem('Universitário', this)">Selecionar</button>
                </div>
                <div class="origem-card" data-origem="vingativo">
                    <h3>Vingativo</h3>
                    <p>Motivado pela busca de vingança por eventos do passado.</p>
                    <button class="selecionar-origem" onclick="selecionarOrigem('Vingativo', this)">Selecionar</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal de Seleção de Família-Base -->
    <div class="modal-origens" id="modal-familias">
        <div class="modal-content">
            <span class="close-modal" onclick="closeFamiliaBaseModal()">&times;</span>
            <h2>Selecione sua Família-Base</h2>
            <div class="origem-grid">
                <div class="origem-card">
                    <h3>Ryu</h3>
                    <p>Florescer carmesim</p>
                    <button class="selecionar-origem" onclick="selecionarFamiliaBase('Ryu', this)">Selecionar</button>
                </div>
                <div class="origem-card">
                    <h3>Baek</h3>
                    <p>Manipulação vocal</p>
                    <button class="selecionar-origem" onclick="selecionarFamiliaBase('Baek', this)">Selecionar</button>
                </div>
                <div class="origem-card">
                    <h3>Sun</h3>
                    <p>Invocação solar</p>
                    <button class="selecionar-origem" onclick="selecionarFamiliaBase('Sun', this)">Selecionar</button>
                </div>
                <div class="origem-card">
                    <h3>Beaumont</h3>
                    <p>Toque primaveril</p>
                    <button class="selecionar-origem" onclick="selecionarFamiliaBase('Beaumont', this)">Selecionar</button>
                </div>
                <div class="origem-card">
                    <h3>De Lune</h3>
                    <p>Sussurro prismático</p>
                    <button class="selecionar-origem" onclick="selecionarFamiliaBase('De Lune', this)">Selecionar</button>
                </div>
                <div class="origem-card">
                    <h3>Brightmoon</h3>
                    <p>Fragmentos de estrelas</p>
                    <button class="selecionar-origem" onclick="selecionarFamiliaBase('Brightmoon', this)">Selecionar</button>
                </div>
                <div class="origem-card">
                    <h3>Emberfell</h3>
                    <p>Colapso do vazio</p>
                    <button class="selecionar-origem" onclick="selecionarFamiliaBase('Emberfell', this)">Selecionar</button>
                </div>
                <div class="origem-card">
                    <h3>MontClair</h3>
                    <p>Sanguessuga de mana</p>
                    <button class="selecionar-origem" onclick="selecionarFamiliaBase('MontClair', this)">Selecionar</button>
                </div>
                <div class="origem-card">
                    <h3>Fireheart</h3>
                    <p>Aurora ígnea</p>
                    <button class="selecionar-origem" onclick="selecionarFamiliaBase('Fireheart', this)">Selecionar</button>
                </div>
                <div class="origem-card">
                    <h3>Kaito</h3>
                    <p>Ressonância arcana</p>
                    <button class="selecionar-origem" onclick="selecionarFamiliaBase('Kaito', this)">Selecionar</button>
                </div>
                <div class="origem-card">
                    <h3>Kyung</h3>
                    <p>Fenda do destino</p>
                    <button class="selecionar-origem" onclick="selecionarFamiliaBase('Kyung', this)">Selecionar</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Pop-up de Secreto -->
    <div class="secreto-popup" id="secretoPopup">
        <p>Você descobriu um segredo! 🎉</p>
    </div>

    <script src="script.js"></script>
    <script>
        function openRacaModal() {
            document.getElementById('modal-racas').style.display = 'block';
        }

        function closeRacaModal() {
            document.getElementById('modal-racas').style.display = 'none';
        }

        // Substitui a lógica de escolha de habilidades/magias para TODAS as raças
        function selecionarRaca(raca, button) {
            document.querySelectorAll('.raca-card').forEach(card => {
                card.classList.remove('selected');
            });
            button.closest('.raca-card').classList.add('selected');
            document.querySelector('input[placeholder="Raça"]').value = raca;
            document.querySelector('input[placeholder="Raça"]').dispatchEvent(new Event('input', { bubbles: true }));
            closeRacaModal();

            abrirEscolhaHabilidadesMagiasRaca(raca);
        }

        function abrirEscolhaHabilidadesMagiasRaca(raca) {
            let modal = document.getElementById('modal-raca-escolha');
            if (!modal) {
                modal = document.createElement('div');
                modal.id = 'modal-raca-escolha';
                modal.style = 'position:fixed;top:0;left:0;width:100vw;height:100vh;background:rgba(0,0,0,0.7);z-index:99999;display:flex;align-items:center;justify-content:center;';
                modal.innerHTML = `<div id="modal-raca-conteudo" style="background:#fff;padding:30px 40px;border-radius:12px;min-width:320px;max-width:90vw;max-height:90vh;overflow:auto;text-align:center;position:relative;">
                <button onclick="document.getElementById('modal-raca-escolha').style.display='none'" style="position:absolute;top:10px;right:10px;font-size:20px;background:none;border:none;cursor:pointer;">&times;</button>
                <h2>Escolher Habilidades e Magias de <span id="nome-raca-escolha"></span></h2>
                <div style="margin:30px 0;display:flex;gap:30px;justify-content:center;">
                    <button id="btn-habilidades-raca" style="padding:12px 24px;font-size:1.1em;border-radius:8px;border:1px solid #8e44ad;background:#f3e6fa;color:#6c3483;cursor:pointer;">Habilidades</button>
                    <button id="btn-magias-raca" style="padding:12px 24px;font-size:1.1em;border-radius:8px;border:1px solid #2980b9;background:#eaf6fb;color:#2980b9;cursor:pointer;">Magias</button>
                </div>
                <div id="conteudo-raca"></div>
            </div>`;
                document.body.appendChild(modal);
            }
            document.getElementById('nome-raca-escolha').textContent = raca;
            modal.style.display = 'flex';

            setTimeout(() => {
                document.getElementById('btn-habilidades-raca').onclick = function() {
                    carregarConteudoRaca(raca, 'habilidades');
                };
                document.getElementById('btn-magias-raca').onclick = function() {
                    carregarConteudoRaca(raca, 'magias');
                };
            }, 100);
        }

        function carregarConteudoRaca(raca, tipo) {
            // Espera-se um arquivo por raça: racas/<nome>.html (ex: racas/Bruxa.html, racas/Elfo.html)
            // Se não existir, mostra mensagem padrão
            const url = `racas/${raca.replace(/[^\w]/g, '').toLowerCase()}.html`;
            fetch(url)
                .then(resp => resp.ok ? resp.text() : '')
                .then(html => {
                    let conteudo = '';
                    if (html) {
                        const temp = document.createElement('div');
                        temp.innerHTML = html;
                        if (tipo === 'habilidades') {
                            const habilidades = Array.from(temp.querySelectorAll('.habilidade, .magia')).filter(el => el.classList.contains('habilidade'));
                            if (habilidades.length) {
                                conteudo = `<h2>Habilidades de ${raca}</h2><div id='cards-habilidades-raca' style='display:flex;flex-direction:column;align-items:center;'>` +
                                    habilidades.map(hab => {
                                        const nome = hab.querySelector('h3') ? hab.querySelector('h3').textContent : '';
                                        const desc = hab.querySelector('p') ? hab.querySelector('p').outerHTML : '';
                                        return `<div class='card-escolha-raca' data-tipo='habilidade' data-nome='${nome}' style='display:flex;flex-direction:column;align-items:flex-start;gap:6px;background:#f3e6fa;border:2px solid #8e44ad;border-radius:12px;padding:18px 20px;margin:12px 0;cursor:pointer;transition:box-shadow .2s;box-shadow:0 2px 8px #0001;max-width:420px;'><span style='font-weight:bold;font-size:1.1em;color:#6c3483;'>${nome}</span>${desc}</div>`;
                                    }).join('') +
                                    `</div>`;
                            } else {
                                conteudo = '<p>Habilidades não encontradas para esta raça.</p>';
                            }
                        } else if (tipo === 'magias') {
                            const magias = Array.from(temp.querySelectorAll('.habilidade, .magia')).filter(el => el.classList.contains('magia'));
                            if (magias.length) {
                                conteudo = `<h2>Magias de ${raca}</h2><div id='cards-magias-raca' style='display:flex;flex-direction:column;align-items:center;'>` +
                                    magias.map(mag => {
                                        const nome = mag.querySelector('h3') ? mag.querySelector('h3').textContent : '';
                                        const desc = mag.querySelector('p') ? mag.querySelector('p').outerHTML : '';
                                        return `<div class='card-escolha-raca' data-tipo='magia' data-nome='${nome}' style='display:flex;flex-direction:column;align-items:flex-start;gap:6px;background:#eaf6fb;border:2px solid #2980b9;border-radius:12px;padding:18px 20px;margin:12px 0;cursor:pointer;transition:box-shadow .2s;box-shadow:0 2px 8px #0001;max-width:420px;'><span style='font-weight:bold;font-size:1.1em;color:#2980b9;'>${nome}</span>${desc}</div>`;
                                    }).join('') +
                                    `</div>`;
                            } else {
                                conteudo = '<p>Magias não encontradas para esta raça.</p>';
                            }
                        }
                    } else {
                        conteudo = `<p>Nenhum conteúdo de ${tipo} cadastrado para esta raça.</p>`;
                    }
                    document.getElementById('conteudo-raca').innerHTML = conteudo;
                    setTimeout(applyEventosCardsRaca, 0);
                });
        }

        function applyEventosCardsRaca() {
            const cardsHab = document.querySelectorAll('.card-escolha-raca[data-tipo="habilidade"]');
            const cardsMag = document.querySelectorAll('.card-escolha-raca[data-tipo="magia"]');
            cardsHab.forEach(card => {
                card.onclick = function() {
                    window.habilidadeRacaEscolhida = card.getAttribute('data-nome');
                    if (!document.getElementById('escolha-habilidade-raca')) criarBarraRaca(document.querySelector('input[placeholder="Raça"]').value);
                    document.getElementById('escolha-habilidade-raca').innerHTML = card.innerHTML;
                    cardsHab.forEach(x => x.style.boxShadow = '0 2px 8px #0001');
                    card.style.boxShadow = '0 0 0 3px #8e44ad';
                };
            });
            cardsMag.forEach(card => {
                card.onclick = function() {
                    window.magiaRacaEscolhida = card.getAttribute('data-nome');
                    if (!document.getElementById('escolha-magia-raca')) criarBarraRaca(document.querySelector('input[placeholder="Raça"]').value);
                    document.getElementById('escolha-magia-raca').innerHTML = card.innerHTML;
                    cardsMag.forEach(x => x.style.boxShadow = '0 2px 8px #0001');
                    card.style.boxShadow = '0 0 0 3px #2980b9';
                };
            });
        }

        // Remove barra antiga de bruxa se existir
        function removerBarraBruxa() {
            const bar = document.getElementById('escolhas-bruxa-bar');
            if (bar) bar.remove();
        }

        // Barra fixa para mostrar escolhas da raça
        function criarBarraRaca(nomeRaca = null) {
            // Remove barra antiga se existir
            const oldBar = document.getElementById('escolhas-raca-bar');
            if (oldBar) oldBar.remove();
            removerBarraBruxa(); // Garante que a barra de bruxa não aparece nunca

            const bar = document.createElement('div');
            bar.id = 'escolhas-raca-bar';
            bar.style = `
                position: fixed; bottom: 0; left: 50%; transform: translateX(-50%);
                width: 95%; max-width: 800px;
                background: #fffbe6;
                padding: 10px 16px;
                display: flex; justify-content: space-between; align-items: center;
                box-shadow: 0 -2px 8px #0002;
                font-size: 1em; color: #222;
                border-radius: 12px 12px 0 0;
                z-index: 10000;
                transition: all 0.2s ease-in-out;
            `;
            const titulo = nomeRaca ? `Escolhas de ${nomeRaca}` : 'Escolhas de Raça';
            bar.innerHTML = `
                <div id="barra-raca-content" style="display: flex; align-items: center; gap: 20px; flex-grow: 1;">
                    <b>${titulo}:</b>
                    <div id="escolha-habilidade-raca" style="flex:1;">Nenhuma habilidade.</div>
                    <div id="escolha-magia-raca" style="flex:1;">Nenhuma magia.</div>
                </div>
                <button id="toggle-barra-raca-btn" onclick="toggleBarraRaca()" style="background:none; border:none; cursor:pointer; font-size: 1.5em; padding: 0 10px; line-height: 1;">▼</button>
            `;
            document.body.appendChild(bar);
            requestAnimationFrame(() => {
                const barHeight = bar.offsetHeight;
                document.body.style.paddingBottom = `${barHeight + 20}px`;
            });
        }

        // Inicializa barra sem raça escolhida e remove barra de bruxa
        document.addEventListener('DOMContentLoaded', function() {
            criarBarraRaca();
            removerBarraBruxa();
        });

        // Ao escolher uma raça, atualiza barra com nome da raça e remove barra de bruxa
        function selecionarRaca(raca, button) {
            document.querySelectorAll('.raca-card').forEach(card => {
                card.classList.remove('selected');
            });
            button.closest('.raca-card').classList.add('selected');
            document.querySelector('input[placeholder="Raça"]').value = raca;
            document.querySelector('input[placeholder="Raça"]').dispatchEvent(new Event('input', { bubbles: true }));
            closeRacaModal();

            criarBarraRaca(raca);
            removerBarraBruxa();
            abrirEscolhaHabilidadesMagiasRaca(raca);
        }

        // Função para fechar o modal
        function fecharModalPericia() {
            document.getElementById('modal-pericias').style.display = 'none';
        }

        // Fecha o modal quando clicar fora dele
        window.onclick = function (event) {
            const modal = document.getElementById('modal-pericias');
            if (event.target == modal) {
                fecharModalPericia();
            }
        }

        // Adiciona o evento de clique para rolagem de dados nas perícias
        document.addEventListener('DOMContentLoaded', function () {
            const periciasLabels = document.querySelectorAll('.pericia-item label');
            periciasLabels.forEach(label => {
                label.addEventListener('click', function () {
                    rolarDados(this);
                });
            });
        });

        // Função para atualizar o valor máximo de vida com base em Resiliência
        function atualizarVidaMaxima() {
            // Pega o valor do atributo Resiliência
            let resiliencia = 0;
            document.querySelectorAll('.atributos-sorte .atributo-item').forEach(item => {
                const label = item.querySelector('label');
                if (label && label.textContent.trim() === 'Resiliência') {
                    resiliencia = parseInt(item.querySelector('input').value) || 0;
                }
            });
            // Calcula a vida máxima
            const vidaMaxima = resiliencia * 3 + 20;
            // Busca o status-item correto de Vida
            document.querySelectorAll('.status-item').forEach(item => {
                const label = item.querySelector('label');
                if (label && label.textContent.replace(/\s/g, '').includes('❤️Vida')) {
                    // Atualiza o campo de vida máxima
                    const vidaSpan = item.querySelector('span');
                    if (vidaSpan) vidaSpan.textContent = vidaMaxima;
                    // Atualiza o atributo max do input de vida
                    const vidaInput = item.querySelector('input');
                    if (vidaInput) {
                        vidaInput.max = vidaMaxima;
                        const nivel = parseInt(document.getElementById('nivel-input').value) || 0;
                        if (nivel === 0) {
                            vidaInput.value = vidaMaxima;
                            atualizarStatus(vidaInput);
                        }
                    }
                }
            });
        }

        // Atualiza a vida máxima ao carregar a página e ao mudar Resiliência
        document.addEventListener('DOMContentLoaded', function () {
            atualizarVidaMaxima();
            // Adiciona evento para atualizar ao mudar Resiliência
            document.querySelectorAll('.atributos-sorte .atributo-item').forEach(item => {
                const label = item.querySelector('label');
                if (label && label.textContent.trim() === 'Resiliência') {
                    item.querySelector('input').addEventListener('change', atualizarVidaMaxima);
                }
            });
        });

        // Função para atualizar o valor máximo de sanidade com base em Intelecto e Carisma
        function atualizarSanidadeMaxima() {
            let intelecto = 0;
            let carisma = 0;
            document.querySelectorAll('.atributos-teste .atributo-item').forEach(item => {
                const label = item.querySelector('label');
                if (label && label.textContent.trim() === 'Intelecto') {
                    intelecto = parseInt(item.querySelector('input').value) || 0;
                }
                if (label && label.textContent.trim() === 'Carisma') {
                    carisma = parseInt(item.querySelector('input').value) || 0;
                }
            });
            // Calcula a sanidade máxima
            const sanidadeMaxima = intelecto * 5 + carisma * 3 + 10;
            // Busca o status-item correto de Sanidade
            document.querySelectorAll('.status-item').forEach(item => {
                const label = item.querySelector('label');
                if (label && label.textContent.replace(/\s/g, '').includes('🧠Sanidade')) {
                    // Atualiza o campo de sanidade máxima
                    const sanidadeSpan = item.querySelector('span');
                    if (sanidadeSpan) sanidadeSpan.textContent = sanidadeMaxima;
                    // Atualiza o atributo max do input de sanidade
                    const sanidadeInput = item.querySelector('input');
                    if (sanidadeInput) {
                        sanidadeInput.max = sanidadeMaxima;
                        const nivel = parseInt(document.getElementById('nivel-input').value) || 0;
                        if (nivel === 0) {
                            sanidadeInput.value = sanidadeMaxima;
                            atualizarStatus(sanidadeInput);
                        }
                    }
                }
            });
        }

        // Atualiza a sanidade máxima ao carregar a página e ao mudar Intelecto ou Carisma
        document.addEventListener('DOMContentLoaded', function () {
            atualizarSanidadeMaxima();
            // Adiciona evento para atualizar ao mudar Intelecto ou Carisma
            document.querySelectorAll('.atributos-teste .atributo-item').forEach(item => {
                const label = item.querySelector('label');
                if (label && (label.textContent.trim() === 'Intelecto' || label.textContent.trim() === 'Carisma')) {
                    item.querySelector('input').addEventListener('change', atualizarSanidadeMaxima);
                }
            });
        });

        // Função para atualizar o valor máximo de mana com base em Magia
        function atualizarManaMaxima() {
            let magia = 0;
            document.querySelectorAll('.atributos-teste .atributo-item').forEach(item => {
                const label = item.querySelector('label');
                if (label && label.textContent.trim() === 'Magia') {
                    magia = parseInt(item.querySelector('input').value) || 0;
                }
            });
            // Calcula a mana máxima
            const manaMaxima = magia * 5 + 15;
            // Busca o status-item correto de Mana
            document.querySelectorAll('.status-item').forEach(item => {
                const label = item.querySelector('label');
                if (label && label.textContent.replace(/\s/g, '').includes('⚡Mana')) {
                    // Atualiza o campo de mana máxima
                    const manaSpan = item.querySelector('span');
                    if (manaSpan) manaSpan.textContent = manaMaxima;
                    // Atualiza o atributo max do input de mana
                    const manaInput = item.querySelector('input');
                    if (manaInput) {
                        manaInput.max = manaMaxima;
                        const nivel = parseInt(document.getElementById('nivel-input').value) || 0;
                        if (nivel === 0) {
                            manaInput.value = manaMaxima;
                            atualizarStatus(manaInput);
                        }
                    }
                }
            });
        }

        // Atualiza a mana máxima ao carregar a página e ao mudar Magia
        document.addEventListener('DOMContentLoaded', function () {
            atualizarManaMaxima();
            // Adiciona evento para atualizar ao mudar Magia
            document.querySelectorAll('.atributos-teste .atributo-item').forEach(item => {
                const label = item.querySelector('label');
                if (label && label.textContent.trim() === 'Magia') {
                    item.querySelector('input').addEventListener('change', atualizarManaMaxima);
                }
            });
        });

        // Função para atualizar o valor máximo de alma com base em Magia, Resiliência e Intelecto
        function atualizarAlmaMaxima() {
            let magia = 0;
            let resiliencia = 0;
            let intelecto = 0;
            // Busca Magia e Intelecto nos atributos de teste
            document.querySelectorAll('.atributos-teste .atributo-item').forEach(item => {
                const label = item.querySelector('label');
                if (label && label.textContent.trim() === 'Magia') {
                    magia = parseInt(item.querySelector('input').value) || 0;
                }
                if (label && label.textContent.trim() === 'Intelecto') {
                    intelecto = parseInt(item.querySelector('input').value) || 0;
                }
            });
            // Busca Resiliência nos atributos de sorte
            document.querySelectorAll('.atributos-sorte .atributo-item').forEach(item => {
                const label = item.querySelector('label');
                if (label && label.textContent.trim() === 'Resiliência') {
                    resiliencia = parseInt(item.querySelector('input').value) || 0;
                }
            });
            // Calcula a alma máxima
            const almaMaxima = magia * 5 + resiliencia * 3 + intelecto * 2 + 15;
            // Busca o status-item correto de Alma
            document.querySelectorAll('.status-item').forEach(item => {
                const label = item.querySelector('label');
                if (label && label.textContent.replace(/\s/g, '').includes('⭐Alma')) {
                    // Atualiza o campo de alma máxima
                    const almaSpan = item.querySelector('span');
                    if (almaSpan) almaSpan.textContent = almaMaxima;
                    // Atualiza o atributo max do input de alma
                    const almaInput = item.querySelector('input');
                    if (almaInput) {
                        almaInput.max = almaMaxima;
                        const nivel = parseInt(document.getElementById('nivel-input').value) || 0;
                        if (nivel === 0) {
                            almaInput.value = almaMaxima;
                            atualizarStatus(almaInput);
                        }
                    }
                }
            });
        }

        // Atualiza a alma máxima ao carregar a página e ao mudar Magia, Resiliência ou Intelecto
        document.addEventListener('DOMContentLoaded', function () {
            atualizarAlmaMaxima();
            // Adiciona evento para atualizar ao mudar Magia ou Intelecto
            document.querySelectorAll('.atributos-teste .atributo-item').forEach(item => {
                const label = item.querySelector('label');
                if (label && (label.textContent.trim() === 'Magia' || label.textContent.trim() === 'Intelecto')) {
                    item.querySelector('input').addEventListener('change', atualizarAlmaMaxima);
                }
            });
            // Adiciona evento para atualizar ao mudar Resiliência
            document.querySelectorAll('.atributos-sorte .atributo-item').forEach(item => {
                const label = item.querySelector('label');
                               if (label && label.textContent.trim() === 'Resiliência') {
                    item.querySelector('input').addEventListener('change', atualizarAlmaMaxima);
                }
            });
        });

        // INVENTÁRIO
        function calcularCapacidadeInventario() {
            let forca = 0;
            const forcaInput = Array.from(document.querySelectorAll('.atributos-teste .atributo-item')).find(item => {
                const label = item.querySelector('label');
                return label && label.textContent.trim() === 'Força';
            })?.querySelector('input');
            if (forcaInput) {
                if (forcaInput.value === '' || isNaN(parseInt(forcaInput.value))) {
                    forcaInput.value = 0;
                }
                forca = parseInt(forcaInput.value) || 0;
            }
            // Soma todos os bônus de carga dos itens
            let bonusCarga = 0;
            document.querySelectorAll('.item-inventario input[placeholder="Bônus de Carga"]').forEach(input => {
                bonusCarga += parseInt(input.value) || 0;
            });
            // Garante que a capacidade nunca será menor que 3
            return Math.max(3,  3 + (forca * 2) + bonusCarga);
        }

        function atualizarInventarioUI() {
            const capacidade = calcularCapacidadeInventario();
            const lista = document.getElementById('lista-itens');
            const itens = lista.querySelectorAll('.item-inventario');
            document.getElementById('capacidade-inventario').textContent = capacidade;
            document.getElementById('contador-itens').textContent = itens.length;
            document.getElementById('adicionar-item').disabled = itens.length >= capacidade;
        }

        function adicionarItemInventario(valor = '') {
            const lista = document.getElementById('lista-itens');
            const capacidade = calcularCapacidadeInventario();
            if (lista.querySelectorAll('.item-inventario').length >= capacidade) return;
            const div = document.createElement('div');
            div.className = 'item-inventario';
            div.innerHTML = `<input type="text" placeholder="Nome do item" value="${valor}"><input type="number" placeholder="Bônus de Carga" value="0" style="width:80px"><button type="button" title="Remover">✖</button>`;
            div.querySelector('button').onclick = function () {
                div.remove();
                atualizarInventarioUI();
            };
            // Adiciona o event listener para o campo Bônus de Carga
            const bonusInput = div.querySelector('input[placeholder="Bônus de Carga"]');
            if (bonusInput) {
                bonusInput.addEventListener('input', atualizarInventarioUI);
            }
            lista.appendChild(div);
            atualizarInventarioUI();
        }

        document.addEventListener('DOMContentLoaded', function () {
            atualizarInventarioUI();
            document.getElementById('adicionar-item').onclick = function () {
                adicionarItemInventario();
            };
            // Atualiza capacidade ao mudar Força
            document.querySelectorAll('.atributos-teste .atributo-item').forEach(item => {
                const label = item.querySelector('label');
                if (label && label.textContent.trim() === 'Força') {
                    item.querySelector('input').addEventListener('input', function () {
                        atualizarInventarioUI();
                        // Remove itens extras se capacidade diminuir
                        const capacidade = calcularCapacidadeInventario();
                        const lista = document.getElementById('lista-itens');
                        while (lista.querySelectorAll('.item-inventario').length > capacidade) {
                            lista.lastChild.remove();
                        }
                    });
                }
            });
        });

        document.getElementById('nivel-input').addEventListener('input', function () {
            const progress = document.querySelector('.progress');
            progress.style.width = this.value + '%';
        });

        window.addEventListener('load', function() {
    atualizarInventarioUI();
});
    </script>
</body>

</html>